From 4a3a83da8c6ce035d01775d8bafd49f0d1b33fb0 Mon Sep 17 00:00:00 2001
From: David Tolnay <dtolnay@gmail.com>
Date: Wed, 16 Mar 2022 11:49:12 -0700
Subject: [PATCH] Fix panic on comma after 'mut self' in bare fn type

---
 src/ty.rs | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/ty.rs b/src/ty.rs
index c38200f9..410e701e 100644
--- a/src/ty.rs
+++ b/src/ty.rs
@@ -740,7 +740,10 @@ pub mod parsing {
                         break;
                     }
 
-                    inputs.push_punct(args.parse()?);
+                    let comma = args.parse()?;
+                    if !has_mut_self {
+                        inputs.push_punct(comma);
+                    }
                 }
 
                 inputs
-- 
2.34.1

