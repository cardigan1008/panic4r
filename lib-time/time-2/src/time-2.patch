From f33e33f6326b063cbbdd058c06a863e4590cf4bb Mon Sep 17 00:00:00 2001
From: Jacob Pratt <the.z.cuber@gmail.com>
Date: Sat, 8 Feb 2020 21:03:30 -0500
Subject: [PATCH] Avoid panic on parsing empty string

Fixes #215.
---
 CHANGELOG.md        | 4 ++++
 src/format/parse.rs | 5 +++++
 2 files changed, 9 insertions(+)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index fbaa7cd..fc16171 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -55,6 +55,10 @@ Versioning].
   - `impl From<SystemTime> for PrimitiveDateTime`
   - `impl From<PrimitiveDateTime> for SystemTime`
 
+### Fixed
+
+- Avoid panics when parsing an empty string (#215).
+
 ## Pre-0.2.7
 
 Prior to v0.2.7, changes were listed in GitHub releases.
diff --git a/src/format/parse.rs b/src/format/parse.rs
index f6ef75f..3bcefbb 100644
--- a/src/format/parse.rs
+++ b/src/format/parse.rs
@@ -293,6 +293,11 @@ pub(crate) fn try_consume_exact_digits<T: FromStr>(
             return None;
         }
 
+        // Ensure the string is long enough to perform the slicing.
+        if (num_digits - pad_size) > s.len() {
+            return None;
+        }
+
         // Because we're only dealing with ASCII digits here, we know that the
         // length is equal to the number of bytes, as ASCII values are always one
         // byte in Unicode.
-- 
2.25.1

